<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Entities &mdash; Telethon 0.145 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Chats vs Channels" href="chats-vs-channels.html" />
    <link rel="prev" title="String-based Debugging" href="strings.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Telethon
          </a>
              <div class="version">
                0.145
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">First Steps</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../basic/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basic/signing-in.html">Signing In</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basic/quick-start.html">Quick-Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basic/updates.html">Updates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basic/next-steps.html">Next Steps</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Quick References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../quick-references/faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quick-references/client-reference.html">Client Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quick-references/events-reference.html">Events Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quick-references/objects-reference.html">Objects Reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Concepts</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="strings.html">String-based Debugging</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Entities</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#what-is-an-entity">What is an Entity?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#getting-entities">Getting Entities</a></li>
<li class="toctree-l2"><a class="reference internal" href="#entities-vs-input-entities">Entities vs. Input Entities</a></li>
<li class="toctree-l2"><a class="reference internal" href="#full-entities">Full Entities</a></li>
<li class="toctree-l2"><a class="reference internal" href="#accessing-entities">Accessing Entities</a></li>
<li class="toctree-l2"><a class="reference internal" href="#summary">Summary</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="chats-vs-channels.html">Chats vs Channels</a></li>
<li class="toctree-l1"><a class="reference internal" href="updates.html">Updates in Depth</a></li>
<li class="toctree-l1"><a class="reference internal" href="sessions.html">Session Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="full-api.html">The Full API</a></li>
<li class="toctree-l1"><a class="reference internal" href="errors.html">RPC Errors</a></li>
<li class="toctree-l1"><a class="reference internal" href="botapi-vs-mtproto.html">HTTP Bot API vs MTProto</a></li>
<li class="toctree-l1"><a class="reference internal" href="asyncio.html">Mastering asyncio</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Full API Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../examples/word-of-warning.html">A Word of Warning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/chats-and-channels.html">Working with Chats and Channels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/users.html">Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/working-with-messages.html">Working with messages</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../developing/philosophy.html">Philosophy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developing/test-servers.html">Test Servers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developing/project-structure.html">Project Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developing/coding-style.html">Coding Style</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developing/testing.html">Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developing/understanding-the-type-language.html">Understanding the Type Language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developing/tips-for-porting-the-project.html">Tips for Porting the Project</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developing/telegram-api-in-other-languages.html">Telegram API in Other Languages</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Miscellaneous</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../misc/changelog.html">Changelog (Version History)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/wall-of-shame.html">Wall of Shame</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/compatibility-and-convenience.html">Compatibility and Convenience</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Telethon Modules</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modules/client.html">TelegramClient</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/events.html">Update Events</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/custom.html">Custom package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/utils.html">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/errors.html">API Errors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/sessions.html">Sessions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/network.html">Connection Modes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/helpers.html">Helpers</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Telethon</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a></li>
      <li class="breadcrumb-item active">Entities</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/concepts/entities.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="entities">
<span id="id1"></span><h1><a class="toc-backref" href="#id2">Entities</a><a class="headerlink" href="#entities" title="Permalink to this heading"></a></h1>
<p>The library widely uses the concept of “entities”. An entity will refer
to any <a class="reference external" href="https://tl.telethon.dev/?q=User">User</a>, <a class="reference external" href="https://tl.telethon.dev/?q=Chat">Chat</a> or <a class="reference external" href="https://tl.telethon.dev/?q=Channel">Channel</a> object that the API may return
in response to certain methods, such as <a class="reference external" href="https://tl.telethon.dev/?q=GetUsersRequest">GetUsersRequest</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When something “entity-like” is required, it means that you need to
provide something that can be turned into an entity. These things include,
but are not limited to, usernames, exact titles, IDs, <a class="reference external" href="https://tl.telethon.dev/?q=Peer">Peer</a> objects,
or even entire <a class="reference external" href="https://tl.telethon.dev/?q=User">User</a>, <a class="reference external" href="https://tl.telethon.dev/?q=Chat">Chat</a> and <a class="reference external" href="https://tl.telethon.dev/?q=Channel">Channel</a> objects and even
phone numbers <strong>from people you have in your contact list</strong>.</p>
<p>To “encounter” an ID, you would have to “find it” like you would in the
normal app. If the peer is in your dialogs, you would need to
<a class="reference internal" href="../modules/client.html#telethon.client.dialogs.DialogMethods.get_dialogs" title="telethon.client.dialogs.DialogMethods.get_dialogs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">client.get_dialogs()</span></code></a>.
If the peer is someone in a group, you would similarly
<a class="reference internal" href="../modules/client.html#telethon.client.chats.ChatMethods.get_participants" title="telethon.client.chats.ChatMethods.get_participants"><code class="xref py py-obj docutils literal notranslate"><span class="pre">client.get_participants(group)</span></code></a>.</p>
<p>Once you have encountered an ID, the library will (by default) have saved
their <code class="docutils literal notranslate"><span class="pre">access_hash</span></code> for you, which is needed to invoke most methods.
This is why sometimes you might encounter this error when working with
the library. You should <code class="docutils literal notranslate"><span class="pre">except</span> <span class="pre">ValueError</span></code> and run code that you know
should work to find the entity.</p>
</div>
<div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#entities" id="id2">Entities</a></p>
<ul>
<li><p><a class="reference internal" href="#what-is-an-entity" id="id3">What is an Entity?</a></p></li>
<li><p><a class="reference internal" href="#getting-entities" id="id4">Getting Entities</a></p></li>
<li><p><a class="reference internal" href="#entities-vs-input-entities" id="id5">Entities vs. Input Entities</a></p></li>
<li><p><a class="reference internal" href="#full-entities" id="id6">Full Entities</a></p></li>
<li><p><a class="reference internal" href="#accessing-entities" id="id7">Accessing Entities</a></p></li>
<li><p><a class="reference internal" href="#summary" id="id8">Summary</a></p></li>
</ul>
</li>
</ul>
</div>
<section id="what-is-an-entity">
<h2><a class="toc-backref" href="#id3">What is an Entity?</a><a class="headerlink" href="#what-is-an-entity" title="Permalink to this heading"></a></h2>
<p>A lot of methods and requests require <em>entities</em> to work. For example,
you send a message to an <em>entity</em>, get the username of an <em>entity</em>, and
so on.</p>
<p>There are a lot of things that work as entities: usernames, phone numbers,
chat links, invite links, IDs, and the types themselves. That is, you can
use any of those when you see an “entity” is needed.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Remember that the phone number must be in your contact list before you
can use it.</p>
</div>
<p>You should use, <strong>from better to worse</strong>:</p>
<ol class="arabic simple">
<li><p>Input entities. For example, <a class="reference internal" href="../modules/custom.html#telethon.tl.custom.chatgetter.ChatGetter.input_chat" title="telethon.tl.custom.chatgetter.ChatGetter.input_chat"><code class="xref py py-obj docutils literal notranslate"><span class="pre">event.input_chat</span></code></a>,
<a class="reference internal" href="../modules/custom.html#telethon.tl.custom.sendergetter.SenderGetter.input_sender" title="telethon.tl.custom.sendergetter.SenderGetter.input_sender"><code class="xref py py-obj docutils literal notranslate"><span class="pre">message.input_sender</span></code></a>,
or caching an entity you will use a lot with
<code class="docutils literal notranslate"><span class="pre">entity</span> <span class="pre">=</span> <span class="pre">await</span> <span class="pre">client.get_input_entity(...)</span></code>.</p></li>
<li><p>Entities. For example, if you had to get someone’s
username, you can just use <code class="docutils literal notranslate"><span class="pre">user</span></code> or <code class="docutils literal notranslate"><span class="pre">channel</span></code>.
It will work. Only use this option if you already have the entity!</p></li>
<li><p>IDs. This will always look the entity up from the
cache (the <code class="docutils literal notranslate"><span class="pre">*.session</span></code> file caches seen entities).</p></li>
<li><p>Usernames, phone numbers and links. The cache will be
used too (unless you force a <a class="reference internal" href="../modules/client.html#telethon.client.users.UserMethods.get_entity" title="telethon.client.users.UserMethods.get_entity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">client.get_entity()</span></code></a>),
but may make a request if the username, phone or link
has not been found yet.</p></li>
</ol>
<p>In recent versions of the library, the following two are equivalent:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">handler</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
    <span class="k">await</span> <span class="n">client</span><span class="o">.</span><span class="n">send_message</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">sender_id</span><span class="p">,</span> <span class="s1">&#39;Hi&#39;</span><span class="p">)</span>
    <span class="k">await</span> <span class="n">client</span><span class="o">.</span><span class="n">send_message</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">input_sender</span><span class="p">,</span> <span class="s1">&#39;Hi&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>If you need to be 99% sure that the code will work (sometimes it’s
simply impossible for the library to find the input entity), or if
you will reuse the chat a lot, consider using the following instead:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">handler</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
    <span class="c1"># This method may make a network request to find the input sender.</span>
    <span class="c1"># Properties can&#39;t make network requests, so we need a method.</span>
    <span class="n">sender</span> <span class="o">=</span> <span class="k">await</span> <span class="n">event</span><span class="o">.</span><span class="n">get_input_sender</span><span class="p">()</span>
    <span class="k">await</span> <span class="n">client</span><span class="o">.</span><span class="n">send_message</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="s1">&#39;Hi&#39;</span><span class="p">)</span>
    <span class="k">await</span> <span class="n">client</span><span class="o">.</span><span class="n">send_message</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="s1">&#39;Hi&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="getting-entities">
<h2><a class="toc-backref" href="#id4">Getting Entities</a><a class="headerlink" href="#getting-entities" title="Permalink to this heading"></a></h2>
<p>Through the use of the <a class="reference internal" href="sessions.html#sessions"><span class="std std-ref">Session Files</span></a>, the library will automatically
remember the ID and hash pair, along with some extra information, so
you’re able to just do this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># (These examples assume you are inside an &quot;async def&quot;)</span>
<span class="c1">#</span>
<span class="c1"># Dialogs are the &quot;conversations you have open&quot;.</span>
<span class="c1"># This method returns a list of Dialog, which</span>
<span class="c1"># has the .entity attribute and other information.</span>
<span class="c1">#</span>
<span class="c1"># This part is IMPORTANT, because it fills the entity cache.</span>
<span class="n">dialogs</span> <span class="o">=</span> <span class="k">await</span> <span class="n">client</span><span class="o">.</span><span class="n">get_dialogs</span><span class="p">()</span>

<span class="c1"># All of these work and do the same.</span>
<span class="n">username</span> <span class="o">=</span> <span class="k">await</span> <span class="n">client</span><span class="o">.</span><span class="n">get_entity</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">)</span>
<span class="n">username</span> <span class="o">=</span> <span class="k">await</span> <span class="n">client</span><span class="o">.</span><span class="n">get_entity</span><span class="p">(</span><span class="s1">&#39;t.me/username&#39;</span><span class="p">)</span>
<span class="n">username</span> <span class="o">=</span> <span class="k">await</span> <span class="n">client</span><span class="o">.</span><span class="n">get_entity</span><span class="p">(</span><span class="s1">&#39;https://telegram.dog/username&#39;</span><span class="p">)</span>

<span class="c1"># Other kind of entities.</span>
<span class="n">channel</span> <span class="o">=</span> <span class="k">await</span> <span class="n">client</span><span class="o">.</span><span class="n">get_entity</span><span class="p">(</span><span class="s1">&#39;telegram.me/joinchat/AAAAAEkk2WdoDrB4-Q8-gg&#39;</span><span class="p">)</span>
<span class="n">contact</span> <span class="o">=</span> <span class="k">await</span> <span class="n">client</span><span class="o">.</span><span class="n">get_entity</span><span class="p">(</span><span class="s1">&#39;+34xxxxxxxxx&#39;</span><span class="p">)</span>
<span class="n">friend</span>  <span class="o">=</span> <span class="k">await</span> <span class="n">client</span><span class="o">.</span><span class="n">get_entity</span><span class="p">(</span><span class="n">friend_id</span><span class="p">)</span>

<span class="c1"># Getting entities through their ID (User, Chat or Channel)</span>
<span class="n">entity</span> <span class="o">=</span> <span class="k">await</span> <span class="n">client</span><span class="o">.</span><span class="n">get_entity</span><span class="p">(</span><span class="n">some_id</span><span class="p">)</span>

<span class="c1"># You can be more explicit about the type for said ID by wrapping</span>
<span class="c1"># it inside a Peer instance. This is recommended but not necessary.</span>
<span class="kn">from</span> <span class="nn">telethon.tl.types</span> <span class="kn">import</span> <span class="n">PeerUser</span><span class="p">,</span> <span class="n">PeerChat</span><span class="p">,</span> <span class="n">PeerChannel</span>

<span class="n">my_user</span>    <span class="o">=</span> <span class="k">await</span> <span class="n">client</span><span class="o">.</span><span class="n">get_entity</span><span class="p">(</span><span class="n">PeerUser</span><span class="p">(</span><span class="n">some_id</span><span class="p">))</span>
<span class="n">my_chat</span>    <span class="o">=</span> <span class="k">await</span> <span class="n">client</span><span class="o">.</span><span class="n">get_entity</span><span class="p">(</span><span class="n">PeerChat</span><span class="p">(</span><span class="n">some_id</span><span class="p">))</span>
<span class="n">my_channel</span> <span class="o">=</span> <span class="k">await</span> <span class="n">client</span><span class="o">.</span><span class="n">get_entity</span><span class="p">(</span><span class="n">PeerChannel</span><span class="p">(</span><span class="n">some_id</span><span class="p">))</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You <strong>don’t</strong> need to get the entity before using it! Just let the
library do its job. Use a phone from your contacts, username, ID or
input entity (preferred but not necessary), whatever you already have.</p>
</div>
<p>All methods in the <a class="reference internal" href="../modules/client.html#telethon-client"><span class="std std-ref">TelegramClient</span></a> call <a class="reference internal" href="../modules/client.html#telethon.client.users.UserMethods.get_input_entity" title="telethon.client.users.UserMethods.get_input_entity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">.get_input_entity()</span></code></a> prior
to sending the request to save you from the hassle of doing so manually.
That way, convenience calls such as <a class="reference internal" href="../modules/client.html#telethon.client.messages.MessageMethods.send_message" title="telethon.client.messages.MessageMethods.send_message"><code class="xref py py-obj docutils literal notranslate"><span class="pre">client.send_message('username',</span> <span class="pre">'hi!')</span></code></a>
become possible.</p>
<p>Every entity the library encounters (in any response to any call) will by
default be cached in the <code class="docutils literal notranslate"><span class="pre">.session</span></code> file (an SQLite database), to avoid
performing unnecessary API calls. If the entity cannot be found, additonal
calls like <a class="reference external" href="https://tl.telethon.dev/?q=ResolveUsernameRequest">ResolveUsernameRequest</a> or <a class="reference external" href="https://tl.telethon.dev/?q=GetContactsRequest">GetContactsRequest</a> may be
made to obtain the required information.</p>
</section>
<section id="entities-vs-input-entities">
<h2><a class="toc-backref" href="#id5">Entities vs. Input Entities</a><a class="headerlink" href="#entities-vs-input-entities" title="Permalink to this heading"></a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This section is informative, but worth reading. The library
will transparently handle all of these details for you.</p>
</div>
<p>On top of the normal types, the API also make use of what they call their
<code class="docutils literal notranslate"><span class="pre">Input*</span></code> versions of objects. The input version of an entity (e.g.
<a class="reference external" href="https://tl.telethon.dev/?q=InputPeerUser">InputPeerUser</a>, <a class="reference external" href="https://tl.telethon.dev/?q=InputChat">InputChat</a>, etc.) only contains the minimum
information that’s required from Telegram to be able to identify
who you’re referring to: a <a class="reference external" href="https://tl.telethon.dev/?q=Peer">Peer</a>’s <strong>ID</strong> and <strong>hash</strong>. They
are named like this because they are input parameters in the requests.</p>
<p>Entities’ ID are the same for all user and bot accounts, however, the access
hash is <strong>different for each account</strong>, so trying to reuse the access hash
from one account in another will <strong>not</strong> work.</p>
<p>Sometimes, Telegram only needs to indicate the type of the entity along
with their ID. For this purpose, <a class="reference external" href="https://tl.telethon.dev/?q=Peer">Peer</a> versions of the entities also
exist, which just have the ID. You cannot get the hash out of them since
you should not be needing it. The library probably has cached it before.</p>
<p>Peers are enough to identify an entity, but they are not enough to make
a request with them. You need to know their hash before you can
“use them”, and to know the hash you need to “encounter” them, let it
be in your dialogs, participants, message forwards, etc.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You <em>can</em> use peers with the library. Behind the scenes, they are
replaced with the input variant. Peers “aren’t enough” on their own
but the library will do some more work to use the right type.</p>
</div>
<p>As we just mentioned, API calls don’t need to know the whole information
about the entities, only their ID and hash. For this reason, another method,
<a class="reference internal" href="../modules/client.html#telethon.client.users.UserMethods.get_input_entity" title="telethon.client.users.UserMethods.get_input_entity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">client.get_input_entity()</span></code></a>
is available. This will always use the cache while possible, making zero API
calls most of the time. When a request is made, if you provided the full
entity, e.g. an <a class="reference external" href="https://tl.telethon.dev/?q=User">User</a>, the library will convert it to the required
<a class="reference external" href="https://tl.telethon.dev/?q=InputPeer">InputPeer</a> automatically for you.</p>
<p><strong>You should always favour</strong>
<a class="reference internal" href="../modules/client.html#telethon.client.users.UserMethods.get_input_entity" title="telethon.client.users.UserMethods.get_input_entity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">client.get_input_entity()</span></code></a>
<strong>over</strong>
<a class="reference internal" href="../modules/client.html#telethon.client.users.UserMethods.get_entity" title="telethon.client.users.UserMethods.get_entity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">client.get_entity()</span></code></a>
for this reason! Calling the latter will always make an API call to get
the most recent information about said entity, but invoking requests don’t
need this information, just the <a class="reference external" href="https://tl.telethon.dev/?q=InputPeer">InputPeer</a>. Only use
<a class="reference internal" href="../modules/client.html#telethon.client.users.UserMethods.get_entity" title="telethon.client.users.UserMethods.get_entity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">client.get_entity()</span></code></a>
if you need to get actual information, like the username, name, title, etc.
of the entity.</p>
<p>To further simplify the workflow, since the version <code class="docutils literal notranslate"><span class="pre">0.16.2</span></code> of the
library, the raw requests you make to the API are also able to call
<a class="reference internal" href="../modules/client.html#telethon.client.users.UserMethods.get_input_entity" title="telethon.client.users.UserMethods.get_input_entity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">client.get_input_entity()</span></code></a>
wherever needed, so you can even do things like:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">await</span> <span class="n">client</span><span class="p">(</span><span class="n">SendMessageRequest</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;hello&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>The library will call the <code class="docutils literal notranslate"><span class="pre">.resolve()</span></code> method of the request, which will
resolve <code class="docutils literal notranslate"><span class="pre">'username'</span></code> with the appropriated <a class="reference external" href="https://tl.telethon.dev/?q=InputPeer">InputPeer</a>. Don’t worry if
you don’t get this yet, but remember some of the details here are important.</p>
</section>
<section id="full-entities">
<h2><a class="toc-backref" href="#id6">Full Entities</a><a class="headerlink" href="#full-entities" title="Permalink to this heading"></a></h2>
<p>In addition to <a class="reference external" href="https://tl.telethon.dev/?q=PeerUser">PeerUser</a>, <a class="reference external" href="https://tl.telethon.dev/?q=InputPeerUser">InputPeerUser</a>, <a class="reference external" href="https://tl.telethon.dev/?q=User">User</a> (and its
variants for chats and channels), there is also the concept of <a class="reference external" href="https://tl.telethon.dev/?q=UserFull">UserFull</a>.</p>
<p>This full variant has additional information such as whether the user is
blocked, its notification settings, the bio or about of the user, etc.</p>
<p>There is also <a class="reference external" href="https://tl.telethon.dev/?q=messages.ChatFull">messages.ChatFull</a> which is the equivalent of full entities
for chats and channels, with also the about section of the channel. Note that
the <code class="docutils literal notranslate"><span class="pre">users</span></code> field only contains bots for the channel (so that clients can
suggest commands to use).</p>
<p>You can get both of these by invoking <a class="reference external" href="https://tl.telethon.dev/?q=GetFullUser">GetFullUser</a>, <a class="reference external" href="https://tl.telethon.dev/?q=GetFullChat">GetFullChat</a>
and <a class="reference external" href="https://tl.telethon.dev/?q=GetFullChannel">GetFullChannel</a> respectively.</p>
</section>
<section id="accessing-entities">
<h2><a class="toc-backref" href="#id7">Accessing Entities</a><a class="headerlink" href="#accessing-entities" title="Permalink to this heading"></a></h2>
<p>Although it’s explicitly noted in the documentation that messages
<em>subclass</em> <a class="reference internal" href="../modules/custom.html#telethon.tl.custom.chatgetter.ChatGetter" title="telethon.tl.custom.chatgetter.ChatGetter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ChatGetter</span></code></a>
and <a class="reference internal" href="../modules/custom.html#telethon.tl.custom.sendergetter.SenderGetter" title="telethon.tl.custom.sendergetter.SenderGetter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SenderGetter</span></code></a>,
some people still don’t get inheritance.</p>
<p>When the documentation says “Bases: <a class="reference internal" href="../modules/custom.html#telethon.tl.custom.chatgetter.ChatGetter" title="telethon.tl.custom.chatgetter.ChatGetter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">telethon.tl.custom.chatgetter.ChatGetter</span></code></a>”
it means that the class you’re looking at, <em>also</em> can act as the class it
bases. In this case, <a class="reference internal" href="../modules/custom.html#telethon.tl.custom.chatgetter.ChatGetter" title="telethon.tl.custom.chatgetter.ChatGetter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ChatGetter</span></code></a>
knows how to get the <em>chat</em> where a thing belongs to.</p>
<p>So, a <a class="reference internal" href="../modules/custom.html#telethon.tl.custom.message.Message" title="telethon.tl.custom.message.Message"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Message</span></code></a> is a
<a class="reference internal" href="../modules/custom.html#telethon.tl.custom.chatgetter.ChatGetter" title="telethon.tl.custom.chatgetter.ChatGetter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ChatGetter</span></code></a>.
That means you can do this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">message</span><span class="o">.</span><span class="n">is_private</span>
<span class="n">message</span><span class="o">.</span><span class="n">chat_id</span>
<span class="k">await</span> <span class="n">message</span><span class="o">.</span><span class="n">get_chat</span><span class="p">()</span>
<span class="c1"># ...etc</span>
</pre></div>
</div>
<p><a class="reference internal" href="../modules/custom.html#telethon.tl.custom.sendergetter.SenderGetter" title="telethon.tl.custom.sendergetter.SenderGetter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SenderGetter</span></code></a> is similar:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">message</span><span class="o">.</span><span class="n">user_id</span>
<span class="k">await</span> <span class="n">message</span><span class="o">.</span><span class="n">get_input_user</span><span class="p">()</span>
<span class="n">message</span><span class="o">.</span><span class="n">user</span>
<span class="c1"># ...etc</span>
</pre></div>
</div>
<p>Quite a few things implement them, so it makes sense to reuse the code.
For example, all events (except raw updates) implement <a class="reference internal" href="../modules/custom.html#telethon.tl.custom.chatgetter.ChatGetter" title="telethon.tl.custom.chatgetter.ChatGetter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ChatGetter</span></code></a> since all events occur
in some chat.</p>
</section>
<section id="summary">
<h2><a class="toc-backref" href="#id8">Summary</a><a class="headerlink" href="#summary" title="Permalink to this heading"></a></h2>
<p>TL;DR; If you’re here because of <em>“Could not find the input entity for”</em>,
you must ask yourself “how did I find this entity through official
applications”? Now do the same with the library. Use what applies:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># (These examples assume you are inside an &quot;async def&quot;)</span>
<span class="k">async</span> <span class="k">with</span> <span class="n">client</span><span class="p">:</span>
    <span class="c1"># Does it have a username? Use it!</span>
    <span class="n">entity</span> <span class="o">=</span> <span class="k">await</span> <span class="n">client</span><span class="o">.</span><span class="n">get_entity</span><span class="p">(</span><span class="n">username</span><span class="p">)</span>

    <span class="c1"># Do you have a conversation open with them? Get dialogs.</span>
    <span class="k">await</span> <span class="n">client</span><span class="o">.</span><span class="n">get_dialogs</span><span class="p">()</span>

    <span class="c1"># Are they participant of some group? Get them.</span>
    <span class="k">await</span> <span class="n">client</span><span class="o">.</span><span class="n">get_participants</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">)</span>

    <span class="c1"># Is the entity the original sender of a forwarded message? Get it.</span>
    <span class="k">await</span> <span class="n">client</span><span class="o">.</span><span class="n">get_messages</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

    <span class="c1"># NOW you can use the ID, anywhere!</span>
    <span class="k">await</span> <span class="n">client</span><span class="o">.</span><span class="n">send_message</span><span class="p">(</span><span class="mi">123456</span><span class="p">,</span> <span class="s1">&#39;Hi!&#39;</span><span class="p">)</span>

    <span class="n">entity</span> <span class="o">=</span> <span class="k">await</span> <span class="n">client</span><span class="o">.</span><span class="n">get_entity</span><span class="p">(</span><span class="mi">123456</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">entity</span><span class="p">)</span>
</pre></div>
</div>
<p>Once the library has “seen” the entity, you can use their <strong>integer</strong> ID.
You can’t use entities from IDs the library hasn’t seen. You must make the
library see them <em>at least once</em> and disconnect properly. You know where
the entities are and you must tell the library. It won’t guess for you.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="strings.html" class="btn btn-neutral float-left" title="String-based Debugging" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="chats-vs-channels.html" class="btn btn-neutral float-right" title="Chats vs Channels" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017 - 2019, Lonami.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>